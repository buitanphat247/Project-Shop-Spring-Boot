<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sản phẩm</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.4.14/dist/tailwind.min.css" rel="stylesheet" />
    <link href="https://cdn.vaadin.com/vaadin-icons/vaadin-icons.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindplus/elements@1" type="module"></script>
  </head>
  <body class="bg-gray-50">
    <header th:replace="layouts/header :: header"></header>

    <main class="container mx-auto px-4 py-8">
      <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
        <!-- Sidebar -->
        <aside class="lg:col-span-3 space-y-6">
          <!-- Danh mục -->
          <section class="bg-white rounded-xl shadow-sm border border-gray-200">
            <div class="px-6 pt-5">
              <h2 class="text-[#2f604a] font-bold text-lg border-b-2 border-[#2f604a] inline-block pb-1">DANH MỤC SẢN PHẨM</h2>
            </div>
            <ul class="divide-y divide-gray-100 px-2 py-3">
              <li><a href="#" class="block px-4 py-3 hover:bg-gray-50">Bơ & Trứng</a></li>
              <li><a href="#" class="block px-4 py-3 hover:bg-gray-50">Khuyến mãi hấp dẫn</a></li>
              <li><a href="#" class="block px-4 py-3 hover:bg-gray-50">Nước ép hữu cơ</a></li>
              <li><a href="#" class="block px-4 py-3 hover:bg-gray-50">Rau</a></li>
              <li><a href="#" class="block px-4 py-3 hover:bg-gray-50">Sữa & kem</a></li>
              <li><a href="#" class="block px-4 py-3 hover:bg-gray-50">Thịt hữu cơ</a></li>
              <li><a href="#" class="block px-4 py-3 hover:bg-gray-50">Thực phẩm sạch</a></li>
              <li class="flex items-center justify-between px-4 py-3 hover:bg-gray-50">
                <span>Trái cây & hạt</span>
                <i class="fas fa-plus text-gray-400"></i>
              </li>
              <li><a href="#" class="block px-4 py-3 hover:bg-gray-50">Uncategorized</a></li>
            </ul>
          </section>

          <!-- Khối lượng -->
          <section class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
            <h3 class="text-[#2f604a] font-bold mb-4">KHỐI LƯỢNG</h3>
            <div class="flex flex-wrap gap-3">
              <span class="px-3 py-1 rounded-full bg-gray-100 text-gray-700 text-sm">10KG</span>
              <span class="px-3 py-1 rounded-full bg-gray-100 text-gray-700 text-sm">1KG</span>
              <span class="px-3 py-1 rounded-full bg-gray-100 text-gray-700 text-sm">2KG</span>
              <span class="px-3 py-1 rounded-full bg-gray-100 text-gray-700 text-sm">3KG</span>
              <span class="px-3 py-1 rounded-full bg-gray-100 text-gray-700 text-sm">5KG</span>
            </div>
          </section>

          <!-- Sản phẩm bán chạy (placeholder) -->
          <section class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
            <h3 class="text-[#2f604a] font-bold mb-4">SẢN PHẨM BÁN CHẠY</h3>
            <div class="space-y-4">
              <div class="flex items-center gap-3">
                <img src="https://via.placeholder.com/64x64" class="w-14 h-14 object-contain" alt="sp" />
                <div>
                  <div class="text-sm font-semibold">Cam Hữu Cơ</div>
                  <div class="text-[#cb5439] font-bold text-sm">95.000 đ</div>
                </div>
              </div>
              <div class="flex items-center gap-3">
                <img src="https://via.placeholder.com/64x64" class="w-14 h-14 object-contain" alt="sp" />
                <div>
                  <div class="text-sm font-semibold">Chuối Hữu Cơ</div>
                  <div class="text-[#cb5439] font-bold text-sm">47.000 đ</div>
                </div>
              </div>
            </div>
          </section>
        </aside>

        <!-- Content -->
        <section class="lg:col-span-9 space-y-4">
          <!-- Toolbar -->
          <div class="flex flex-wrap items-center justify-between gap-3 bg-white rounded-xl shadow-sm border border-gray-200 px-4 py-3">
            <div class="text-sm text-gray-700">Hiển thị 1–12 của 16 kết quả</div>
            <div class="flex items-center gap-2">
              <select class="border border-gray-300 rounded-md px-3 py-2 text-sm">
                <option>Thứ tự mặc định</option>
                <option>Giá thấp đến cao</option>
                <option>Giá cao đến thấp</option>
              </select>
              <button class="p-2 rounded-md border border-gray-300 text-gray-500"><i class="fas fa-th"></i></button>
            </div>
          </div>

          <!-- Product grid -->
          <div id="product-grid" class="grid grid-cols-2 md:grid-cols-3 xl:grid-cols-4 gap-5"></div>
          <!-- Pagination -->
          <!-- <div id="pagination" class="mt-6 flex items-center justify-center gap-2"></div> -->
        </section>
      </div>
    </main>

    <footer th:replace="layouts/footer :: footer"></footer>
  </body>
</html>
<script>
  // Sample data (20+ items)
  const products = Array.from({ length: 24 }).map((_, i) => ({
    id: i + 1,
    name: `Sản phẩm Hữu Cơ ${i + 1}`,
    price: [45000, 95000, 130000, 47000][i % 4],
    oldPrice: i % 3 === 0 ? 134000 : null,
    discount: i % 3 === 0 ? "-29%" : i % 4 === 1 ? "-18%" : "",
    available: [8, 12, 5, 20][i % 4],
    sold: [15, 9, 20, 11][i % 4],
    progress: [65, 45, 80, 55][i % 4],
    rating: 3 + (i % 3),
    img: [
      "https://cdn.tgdd.vn/2021/01/CookProduct/2-1200x676-6.jpg",
      "https://mtcs.1cdn.vn/2023/05/30/rau-cu-qua.jpg",
      "https://media.istockphoto.com/id/1155240408/vi/anh/b%C3%A0n-ch%E1%BB%A9a-nhi%E1%BB%81u-lo%E1%BA%A1i-th%E1%BB%B1c-ph%E1%BA%A9m.jpg?s=612x612&w=0&k=20&c=IbFG8N9b41uM-RBYw8r0ASDoJX5RSWz9oDBN4m9gFcY=",
    ][i % 3],
  }));

  const pageSize = 12;
  let currentPage = 1;

  function renderStars(rating) {
    let html = "";
    for (let i = 1; i <= 5; i++) {
      html += `<i class=\"fas fa-star ${i <= rating ? "" : "text-gray-300"}\" style=\"color:#ffb400\"></i>`;
    }
    return html;
  }

  function formatPrice(n) {
    return n.toLocaleString("vi-VN") + " đ";
  }

  function renderGrid() {
    const grid = document.getElementById("product-grid");
    const start = (currentPage - 1) * pageSize;
    const slice = products.slice(start, start + pageSize);
    grid.innerHTML = slice
      .map(
        (p) => `
      <article class=\"bg-white rounded-2xl shadow border border-gray-200 overflow-hidden\">
        <div class=\"p-4\">
          <div class=\"relative aspect-[4/3] bg-white rounded-xl overflow-hidden\">
            <img src=\"${p.img}\" alt=\"${p.name}\" class=\"w-full h-full object-cover\" />
            ${
              p.discount
                ? `<span class=\\\"absolute left-3 top-3 bg-[#e2553f] text-white text-xs font-semibold px-2 py-1 rounded-full\\\">${p.discount}</span>`
                : ""
            }
          </div>
          <h4 class=\"mt-3 text-[15px] font-semibold text-[#1f2d3d]\">${p.name}</h4>
          <div class=\"mt-2\">${renderStars(p.rating)}</div>
          <div class=\"mt-2 flex items-center justify-between\">
            <div class=\"text-[#cb5439] font-extrabold text-xl\">${formatPrice(p.price)}</div>
            <button class=\"w-10 h-10 rounded-full bg-[#2f604a] text-white grid place-items-center hover:bg-[#254d3b]\"><i class=\"fas fa-basket-shopping\"></i></button>
          </div>
          <div class=\"mt-3 flex items-center justify-between text-[13px] text-gray-600\">
            <span>Có sẵn: ${p.available}</span>
            <span>Đã bán: ${p.sold}</span>
          </div>
          <div class=\"mt-2 h-2 w-full bg-gray-200 rounded-full overflow-hidden\">
            <div class=\"h-full bg-[#2f604a] rounded-full\" style=\"width:${p.progress}%\"></div>
          </div>
        </div>
      </article>
    `
      )
      .join("");
  }

  function renderPagination() {
    const totalPages = Math.ceil(products.length / pageSize);
    const container = document.getElementById("pagination");
    if (totalPages <= 1) {
      container.innerHTML = "";
      return;
    }

    function pageButton(num, label = num) {
      const active = num === currentPage ? "bg-[#cb5439] text-white" : "bg-white text-gray-700 hover:bg-gray-50";
      return `<button data-page=\"${num}\" class=\"min-w-9 h-9 px-3 rounded-md border border-gray-300 ${active}\">${label}</button>`;
    }

    let html = "";
    html += pageButton(Math.max(1, currentPage - 1), "&laquo;");
    for (let i = 1; i <= totalPages; i++) html += pageButton(i);
    html += pageButton(Math.min(totalPages, currentPage + 1), "&raquo;");
    container.innerHTML = html;

    // Events
    container.querySelectorAll("button[data-page]").forEach((btn) => {
      btn.addEventListener("click", () => {
        const num = parseInt(btn.getAttribute("data-page"));
        if (num !== currentPage) {
          currentPage = num;
          renderGrid();
          renderPagination();
          window.scrollTo({ top: 0, behavior: "smooth" });
        }
      });
    });
  }

  document.addEventListener("DOMContentLoaded", () => {
    renderGrid();
    renderPagination();
  });
</script>
